!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var s=e();for(var n in s)("object"==typeof exports?exports:t)[n]=s[n]}}(window,(function(){return function(t){var e={};function s(n){if(e[n])return e[n].exports;var o=e[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,s),o.l=!0,o.exports}return s.m=t,s.c=e,s.d=function(t,e,n){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},s.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)s.d(n,o,function(e){return t[e]}.bind(null,o));return n},s.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="",s(s.s=1)}([,function(t,e,s){(function(e){const n=s(3),o="undefined"==typeof window?e:window;o.loaders=o.loaders||{},t.exports=Object.assign(o.loaders,n)}).call(this,s(2))},function(t,e){var s;s=function(){return this}();try{s=s||new Function("return this")()}catch(t){"object"==typeof window&&(s=window)}t.exports=s},function(t,e,s){"use strict";s.r(e),s.d(e,"JSONLoader",(function(){return tt})),s.d(e,"_GeoJSONLoader",(function(){return bt})),s.d(e,"_GeoJSONWorkerLoader",(function(){return yt})),s.d(e,"_JSONPath",(function(){return X})),s.d(e,"_ClarinetParser",(function(){return Y}));const n={batchSize:"auto",convertToObject:!0};class o{constructor(t,e={}){if(e={...n,...e},this.schema=t,this.batchSize=e.batchSize,this.convertToObject=e.convertToObject,this.rows=null,this.length=0,this.isChunkComplete=!1,this.cursor=0,!Array.isArray(t)){this._headers=[];for(const e in t)this._headers[t[e].index]=t[e].name}}addRow(t,e=null){this.rows||(this.rows=new Array(this.batchSize),this.length=0),Number.isFinite(e)&&(this.cursor=e),this.rows[this.length]=this.convertToObject?function(t,e){if(!t)throw new Error("null row");if(!Array.isArray(t))return t;if(!e)return t;const s={};for(let n=0;n<e.length;n++)s[e[n]]=t[n];return s}(t,this._headers):t,this.length++}chunkComplete(){this.isChunkComplete=!0}isFull(){return"auto"===this.batchSize?this.isChunkComplete&&this.length>0:this.rows&&this.length>=this.batchSize}getBatch(){if(this.rows){const t=this.rows.slice(0,this.length);return this.rows=null,this.isChunkComplete=!1,{data:t,schema:this.schema,length:t.length,cursor:this.cursor}}return null}}function i(t,e){try{const s=JSON.parse(t);return e.json.table&&function t(e){if(Array.isArray(e))return e;if(e&&"object"==typeof e)for(const s of Object.values(e)){const e=t(s);if(e)return e}return null}(s)||s}catch(t){throw new Error("JSONLoader: failed to parse JSON")}}class r{constructor(t,e,s=100,n){this.TableBatchType=t,this.schema=e,this.batchSize=s,this.batch=null,this.batchCount=0,this.bytesUsed=0,this.options=n}addRow(t){if(!this.batch){const{TableBatchType:t}=this;this.batch=new t(this.schema,this.batchSize,this.options)}this.batch.addRow(t)}chunkComplete(t){this.bytesUsed+=t.byteLength||t.length||0,this.batch&&this.batch.chunkComplete()}isFull(){return this.batch&&this.batch.isFull()}hasBatch(){return Boolean(this.batch)}getBatch(t={}){if(Number.isFinite(t.bytesUsed)&&(this.bytesUsed=t.bytesUsed),this.batch){const e=this.batch.getBatch();return this.batch=null,e.count=this.batchCount,this.batchCount++,e.bytesUsed=this.bytesUsed,Object.assign(e,t),e}return null}}const a=Number.MAX_SAFE_INTEGER,h="debug"==={}.CDEBUG,c={textNode:void 0,numberNode:""};let u=0;const l={BEGIN:u++,VALUE:u++,OPEN_OBJECT:u++,CLOSE_OBJECT:u++,OPEN_ARRAY:u++,CLOSE_ARRAY:u++,TEXT_ESCAPE:u++,STRING:u++,BACKSLASH:u++,END:u++,OPEN_KEY:u++,CLOSE_KEY:u++,TRUE:u++,TRUE2:u++,TRUE3:u++,FALSE:u++,FALSE2:u++,FALSE3:u++,FALSE4:u++,NULL:u++,NULL2:u++,NULL3:u++,NUMBER_DECIMAL_POINT:u++,NUMBER_DIGIT:u++};for(var p in l)l[l[p]]=p;u=l;const d=9,f=10,g=13,y=32,b=34,m=43,P=44,S=45,w=46,A=48,j=57,E=58,O=69,v=91,C=92,N=93,L=97,_=98,I=101,k=102,U=108,x=110,T=114,F=115,R=116,B=117,J=123,z=125;var M=/[\\"\n]/g;class Y{constructor(t={}){this._initialize(t)}_initialize(t){this._clearBuffers(this),this.bufferCheckPosition=a,this.q="",this.c="",this.p="",this.options=t||{},this.closed=!1,this.closedRoot=!1,this.sawRoot=!1,this.tag=null,this.error=null,this.state=u.BEGIN,this.stack=new Array,this.position=this.column=0,this.line=1,this.slashed=!1,this.unicodeI=0,this.unicodeS=null,this.depth=0,"onready"in t&&(this.onready=t.onready),"onopenobject"in t&&(this.onopenobject=t.onopenobject),"onkey"in t&&(this.onkey=t.onkey),"oncloseobject"in t&&(this.oncloseobject=t.oncloseobject),"onopenarray"in t&&(this.onopenarray=t.onopenarray),"onclosearray"in t&&(this.onclosearray=t.onclosearray),"onvalue"in t&&(this.onvalue=t.onvalue),"onerror"in t&&(this.onerror=t.onerror),"onend"in t&&(this.onend=t.onend),"onchunkparsed"in t&&(this.onchunkparsed=t.onchunkparsed),G(this,"onready")}_clearBuffers(){for(var t in c)this[t]=c[t]}end(){return this.state===u.VALUE&&0===this.depth||$(this,"Unexpected end"),D(this),this.c="",this.closed=!0,G(this,"onend"),this._initialize(this.options),this}resume(){return this.error=null,this}close(){return this.write(null)}write(t){if(this.error)throw this.error;if(this.closed)return $(this,"Cannot write after close. Assign an onready handler.");if(null===t)return this.end();var e=0,s=t.charCodeAt(0),n=this.p;for(h&&console.log("write -> ["+t+"]");s&&(n=s,this.c=s=t.charCodeAt(e++),n!==s?this.p=n:n=this.p,s);)switch(h&&console.log(e,s,l[this.state]),this.position++,s===f?(this.line++,this.column=0):this.column++,this.state){case u.BEGIN:s===J?this.state=u.OPEN_OBJECT:s===v?this.state=u.OPEN_ARRAY:q(s)||$(this,"Non-whitespace before {[.");continue;case u.OPEN_KEY:case u.OPEN_OBJECT:if(q(s))continue;if(this.state===u.OPEN_KEY)this.stack.push(u.CLOSE_KEY);else{if(s===z){G(this,"onopenobject"),this.depth++,G(this,"oncloseobject"),this.depth--,this.state=this.stack.pop()||u.VALUE;continue}this.stack.push(u.CLOSE_OBJECT)}s===b?this.state=u.STRING:$(this,'Malformed object key should start with "');continue;case u.CLOSE_KEY:case u.CLOSE_OBJECT:if(q(s))continue;this.state,u.CLOSE_KEY;s===E?(this.state===u.CLOSE_OBJECT?(this.stack.push(u.CLOSE_OBJECT),D(this,"onopenobject"),this.depth++):D(this,"onkey"),this.state=u.VALUE):s===z?(V(this,"oncloseobject"),this.depth--,this.state=this.stack.pop()||u.VALUE):s===P?(this.state===u.CLOSE_OBJECT&&this.stack.push(u.CLOSE_OBJECT),D(this),this.state=u.OPEN_KEY):$(this,"Bad object");continue;case u.OPEN_ARRAY:case u.VALUE:if(q(s))continue;if(this.state===u.OPEN_ARRAY){if(G(this,"onopenarray"),this.depth++,this.state=u.VALUE,s===N){G(this,"onclosearray"),this.depth--,this.state=this.stack.pop()||u.VALUE;continue}this.stack.push(u.CLOSE_ARRAY)}s===b?this.state=u.STRING:s===J?this.state=u.OPEN_OBJECT:s===v?this.state=u.OPEN_ARRAY:s===R?this.state=u.TRUE:s===k?this.state=u.FALSE:s===x?this.state=u.NULL:s===S?this.numberNode+="-":A<=s&&s<=j?(this.numberNode+=String.fromCharCode(s),this.state=u.NUMBER_DIGIT):$(this,"Bad value");continue;case u.CLOSE_ARRAY:if(s===P)this.stack.push(u.CLOSE_ARRAY),D(this,"onvalue"),this.state=u.VALUE;else if(s===N)V(this,"onclosearray"),this.depth--,this.state=this.stack.pop()||u.VALUE;else{if(q(s))continue;$(this,"Bad array")}continue;case u.STRING:void 0===this.textNode&&(this.textNode="");var o=e-1,i=this.slashed,r=this.unicodeI;t:for(;;){for(h&&console.log(e,s,l[this.state],i);r>0;)if(this.unicodeS+=String.fromCharCode(s),s=t.charCodeAt(e++),this.position++,4===r?(this.textNode+=String.fromCharCode(parseInt(this.unicodeS,16)),r=0,o=e-1):r++,!s)break t;if(s===b&&!i){this.state=this.stack.pop()||u.VALUE,this.textNode+=t.substring(o,e-1),this.position+=e-1-o;break}if(s===C&&!i&&(i=!0,this.textNode+=t.substring(o,e-1),this.position+=e-1-o,s=t.charCodeAt(e++),this.position++,!s))break;if(i){if(i=!1,s===x?this.textNode+="\n":s===T?this.textNode+="\r":s===R?this.textNode+="\t":s===k?this.textNode+="\f":s===_?this.textNode+="\b":s===B?(r=1,this.unicodeS=""):this.textNode+=String.fromCharCode(s),s=t.charCodeAt(e++),this.position++,o=e-1,s)continue;break}M.lastIndex=e;var p=M.exec(t);if(null===p){e=t.length+1,this.textNode+=t.substring(o,e-1),this.position+=e-1-o;break}if(e=p.index+1,!(s=t.charCodeAt(p.index))){this.textNode+=t.substring(o,e-1),this.position+=e-1-o;break}}this.slashed=i,this.unicodeI=r;continue;case u.TRUE:s===T?this.state=u.TRUE2:$(this,"Invalid true started with t"+s);continue;case u.TRUE2:s===B?this.state=u.TRUE3:$(this,"Invalid true started with tr"+s);continue;case u.TRUE3:s===I?(G(this,"onvalue",!0),this.state=this.stack.pop()||u.VALUE):$(this,"Invalid true started with tru"+s);continue;case u.FALSE:s===L?this.state=u.FALSE2:$(this,"Invalid false started with f"+s);continue;case u.FALSE2:s===U?this.state=u.FALSE3:$(this,"Invalid false started with fa"+s);continue;case u.FALSE3:s===F?this.state=u.FALSE4:$(this,"Invalid false started with fal"+s);continue;case u.FALSE4:s===I?(G(this,"onvalue",!1),this.state=this.stack.pop()||u.VALUE):$(this,"Invalid false started with fals"+s);continue;case u.NULL:s===B?this.state=u.NULL2:$(this,"Invalid null started with n"+s);continue;case u.NULL2:s===U?this.state=u.NULL3:$(this,"Invalid null started with nu"+s);continue;case u.NULL3:s===U?(G(this,"onvalue",null),this.state=this.stack.pop()||u.VALUE):$(this,"Invalid null started with nul"+s);continue;case u.NUMBER_DECIMAL_POINT:s===w?(this.numberNode+=".",this.state=u.NUMBER_DIGIT):$(this,"Leading zero not followed by .");continue;case u.NUMBER_DIGIT:A<=s&&s<=j?this.numberNode+=String.fromCharCode(s):s===w?(-1!==this.numberNode.indexOf(".")&&$(this,"Invalid number has two dots"),this.numberNode+="."):s===I||s===O?(-1===this.numberNode.indexOf("e")&&-1===this.numberNode.indexOf("E")||$(this,"Invalid number has two exponential"),this.numberNode+="e"):s===m||s===S?(n!==I&&n!==O&&$(this,"Invalid symbol in number"),this.numberNode+=String.fromCharCode(s)):(K(this),e--,this.state=this.stack.pop()||u.VALUE);continue;default:$(this,"Unknown state: "+this.state)}return this.position>=this.bufferCheckPosition&&function(t){const e=Math.max(a,10);let s=0;for(var n in c){var o=void 0===t[n]?0:t[n].length;if(o>e)switch(n){case"text":closeText(t);break;default:$(t,"Max buffer length exceeded: "+n)}s=Math.max(s,o)}t.bufferCheckPosition=a-s+t.position}(this),G(this,"onchunkparsed"),this}}function G(t,e,s){h&&console.log("-- emit",e,s),t[e]&&t[e](s,t)}function V(t,e,s){D(t),G(t,e,s)}function D(t,e){t.textNode=function(t,e){if(void 0===e)return e;t.trim&&(e=e.trim());t.normalize&&(e=e.replace(/\s+/g," "));return e}(t.options,t.textNode),void 0!==t.textNode&&G(t,e||"onvalue",t.textNode),t.textNode=void 0}function K(t){t.numberNode&&G(t,"onvalue",parseFloat(t.numberNode)),t.numberNode=""}function $(t,e){return D(t),e+="\nLine: "+t.line+"\nColumn: "+t.column+"\nChar: "+t.c,e=new Error(e),t.error=e,G(t,"onerror",e),t}function q(t){return t===g||t===f||t===y||t===d}class X{constructor(t=null){if(this.path=["$"],t instanceof X)this.path=[...t.path];else if(Array.isArray(t))this.path.push(...t);else if("string"==typeof t&&(this.path=t.split("."),"$"!==this.path[0]))throw new Error("JSONPaths must start with $")}clone(){return new X(this)}toString(){return this.path.join(".")}push(t){this.path.push(t)}pop(){return this.path.pop()}set(t){this.path[this.path.length-1]=t}equals(t){if(!this||!t||this.path.length!==t.path.length)return!1;for(let e=0;e<this.path.length;++e)if(this.path[e]!==t.path[e])return!1;return!0}setFieldAtPath(t,e){const s=[...this.path];s.shift();const n=s.pop();for(const e of s)t=t[e];t[n]=e}getFieldAtPath(t){const e=[...this.path];e.shift();const s=e.pop();for(const s of e)t=t[s];return t[s]}}class H extends class{constructor(){this.reset(),this._initializeParser()}reset(){this.result=void 0,this.previousStates=[],this.currentState=Object.freeze({container:[],key:null}),this.jsonpath=new X}write(t){this.parser.write(t)}close(){this.parser.close()}_pushOrSet(t){const{container:e,key:s}=this.currentState;null!==s?(e[s]=t,this.currentState.key=null):e.push(t)}_openArray(t=[]){this.jsonpath.push(null),this._pushOrSet(t),this.previousStates.push(this.currentState),this.currentState={container:t,isArray:!0,key:null}}_closeArray(){this.jsonpath.pop(),this.currentState=this.previousStates.pop()}_openObject(t={}){this.jsonpath.push(null),this._pushOrSet(t),this.previousStates.push(this.currentState),this.currentState={container:t,isArray:!1,key:null}}_closeObject(){this.jsonpath.pop(),this.currentState=this.previousStates.pop()}_initializeParser(){this.parser=new Y({onready:()=>{this.jsonpath=new X,this.previousStates.length=0,this.currentState.container.length=0},onopenobject:t=>{this._openObject({}),void 0!==t&&this.parser.onkey(t)},onkey:t=>{this.jsonpath.set(t),this.currentState.key=t},oncloseobject:()=>{this._closeObject()},onopenarray:()=>{this._openArray()},onclosearray:()=>{this._closeArray()},onvalue:t=>{this._pushOrSet(t)},onerror:t=>{throw t},onend:()=>{this.result=this.currentState.container.pop()}})}}{constructor(t={}){super();const e=t.jsonpaths||[];this.jsonPaths=e.map(t=>new X(t)),this.streamingJsonPath=null,this.streamingArray=null,this.topLevelObject=null,this._extendParser()}write(t){super.write(t);let e=[];return this.streamingArray&&(e=[...this.streamingArray],this.streamingArray.length=0),e}getPartialResult(){return this.topLevelObject}getStreamingJsonPath(){return this.streamingJsonPath}getStreamingJsonPathAsString(){return this.streamingJsonPath&&this.streamingJsonPath.toString()}getJsonPath(){return this.jsonpath}_matchJSONPath(){const t=this.getJsonPath();if(0===this.jsonPaths.length)return!0;for(const e of this.jsonPaths)if(e.equals(t))return!0;return!1}_extendParser(){this.parser.onopenarray=()=>{if(!this.streamingArray&&this._matchJSONPath())return this.streamingJsonPath=this.getJsonPath().clone(),this.streamingArray=[],void this._openArray(this.streamingArray);this._openArray()},this.parser.onopenobject=t=>{this.topLevelObject?this._openObject({}):(this.topLevelObject={},this._openObject(this.topLevelObject)),void 0!==t&&this.parser.onkey(t)}}}async function*W(t,e){t=async function*(t,e){const s=new TextDecoder(e);for await(const e of t)yield"string"==typeof e?e:s.decode(e,{stream:!0})}(t);const{metadata:s}=e,{batchSize:n,_rootObjectBatches:o,jsonpaths:i}=e.json,a=e.json.TableBatch;let h=!0,c=null,u=null;const l=new H({jsonpaths:i});c=c||new r(a,u,{batchSize:n});for await(const e of t){const t=l.write(e),n=t.length>0&&l.getStreamingJsonPathAsString();if(t.length>0&&h){if(s){const t={batchType:"partial-result",container:l.getPartialResult(),data:[],bytesUsed:0,schema:null,jsonpath:n};yield t}if(o){const t={batchType:"root-object-batch-partial",container:l.getPartialResult(),data:[],schema:null};yield t}h=!1,u=Q(t)}for(const e of t)c.addRow(e),c.isFull()&&(yield c.getBatch({jsonpath:n}));c.chunkComplete(e),c.isFull()&&(yield c.getBatch({jsonpath:n}))}const p=l.getStreamingJsonPathAsString(),d=c.getBatch({jsonpath:p});if(d&&(yield d),s){const t={batchType:"final-result",container:l.getPartialResult(),jsonpath:l.getStreamingJsonPathAsString(),data:[],schema:null};yield t}if(o){const t={batchType:"root-object-batch-complete",container:l.getPartialResult(),data:[],schema:null};yield t}}function Q(t){const e=t[0],s={};let n=0;for(const t in e){switch(typeof e[t]){case"number":case"boolean":s[t]={name:String(t),index:n,type:Float32Array};break;case"object":s[t]={name:String(t),index:n,type:Array};break;case"string":default:s[t]={name:String(t),index:n,type:Array}}n++}return s}const Z={json:{TableBatch:o,batchSize:"auto",_rootObjectBatches:!1,table:!1,jsonpaths:[]}},tt={id:"json",name:"JSON",version:"2.3.0-alpha.12",extensions:["json","geojson"],mimeTypes:["application/json"],category:"table",text:!0,parse:async function(t,e){return et((new TextDecoder).decode(t),e)},parseTextSync:et,parseInBatches:async function(t,e){return(e={...Z,...e}).json={...Z.json,...e.json},W(t,e)},options:Z,deprecatedOptions:{json:{_rootObjectBatches:"metadata"}}};function et(t,e){return(e={...Z,...e}).json={...Z.json,...e.json},i(t,e)}function st(t,e={}){const s=nt(t);return ot(t,s,{coordLength:e.coordLength||s.coordLength,numericPropKeys:e.numericPropKeys||s.numericPropKeys,PositionDataType:e.PositionDataType||Float32Array})}function nt(t){let e=0,s=0,n=0,o=0,i=0,r=0,a=0,h=0,c=0;const u=new Set,l={};for(const d of t){const t=d.geometry;switch(t.type){case"Point":s++,e++,u.add(t.coordinates.length);break;case"MultiPoint":s++,e+=t.coordinates.length;for(const e of t.coordinates)u.add(e.length);break;case"LineString":i++,n+=t.coordinates.length,o++;for(const e of t.coordinates)u.add(e.length);break;case"MultiLineString":i++;for(const e of t.coordinates){n+=e.length,o++;for(const t of e)u.add(t.length)}break;case"Polygon":c++,a++,h+=t.coordinates.length,r+=ft(t.coordinates).length;for(const e of ft(t.coordinates))u.add(e.length);break;case"MultiPolygon":c++;for(const e of t.coordinates){a++,h+=e.length,r+=ft(e).length;for(const t of ft(e))u.add(t.length)}break;default:throw new Error("Unsupported geometry type: "+t.type)}if(d.properties)for(const t in d.properties){const e=d.properties[t];l[t]=l[t]||void 0===l[t]?(p=e,Number.isFinite(p)):l[t]}}var p;return{pointPositionsCount:e,pointFeaturesCount:s,linePositionsCount:n,linePathsCount:o,lineFeaturesCount:i,coordLength:Math.max(...u),polygonPositionsCount:r,polygonObjectsCount:a,polygonRingsCount:h,polygonFeaturesCount:c,numericPropKeys:Object.keys(l).filter(t=>l[t])}}function ot(t,e={},s={}){const{pointPositionsCount:n,pointFeaturesCount:o,linePositionsCount:i,linePathsCount:r,lineFeaturesCount:a,polygonPositionsCount:h,polygonObjectsCount:c,polygonRingsCount:u,polygonFeaturesCount:l}=e,{coordLength:p,numericPropKeys:d,PositionDataType:f=Float32Array}=s,g=t.length>65535?Uint32Array:Uint16Array,y={positions:new f(n*p),globalFeatureIds:new g(n),featureIds:o>65535?new Uint32Array(n):new Uint16Array(n),numericProps:{},properties:[]},b={pathIndices:i>65535?new Uint32Array(r+1):new Uint16Array(r+1),positions:new f(i*p),globalFeatureIds:new g(i),featureIds:a>65535?new Uint32Array(i):new Uint16Array(i),numericProps:{},properties:[]},m={polygonIndices:h>65535?new Uint32Array(c+1):new Uint16Array(c+1),primitivePolygonIndices:h>65535?new Uint32Array(u+1):new Uint16Array(u+1),positions:new f(h*p),globalFeatureIds:new g(h),featureIds:l>65535?new Uint32Array(h):new Uint16Array(h),numericProps:{},properties:[]};for(const t of[y,b,m])for(const e of d)t.numericProps[e]=new Float32Array(t.positions.length/p);b.pathIndices[r]=i,m.polygonIndices[c]=h,m.primitivePolygonIndices[u]=h;const P={pointPosition:0,pointFeature:0,linePosition:0,linePath:0,lineFeature:0,polygonPosition:0,polygonObject:0,polygonRing:0,polygonFeature:0,feature:0};for(const e of t){const t=e.geometry,s=e.properties;switch(t.type){case"Point":it(t.coordinates,y,P,p,s),y.properties.push(pt(s,d)),P.pointFeature++;break;case"MultiPoint":rt(t.coordinates,y,P,p,s),y.properties.push(pt(s,d)),P.pointFeature++;break;case"LineString":at(t.coordinates,b,P,p,s),b.properties.push(pt(s,d)),P.lineFeature++;break;case"MultiLineString":ht(t.coordinates,b,P,p,s),b.properties.push(pt(s,d)),P.lineFeature++;break;case"Polygon":ct(t.coordinates,m,P,p,s),m.properties.push(pt(s,d)),P.polygonFeature++;break;case"MultiPolygon":ut(t.coordinates,m,P,p,s),m.properties.push(pt(s,d)),P.polygonFeature++;break;default:throw new Error("Invalid geometry type")}P.feature++}return function(t,e,s,n){const o={points:{positions:{value:t.positions,size:n},globalFeatureIds:{value:t.globalFeatureIds,size:1},featureIds:{value:t.featureIds,size:1},numericProps:t.numericProps,properties:t.properties},lines:{pathIndices:{value:e.pathIndices,size:1},positions:{value:e.positions,size:n},globalFeatureIds:{value:e.globalFeatureIds,size:1},featureIds:{value:e.featureIds,size:1},numericProps:e.numericProps,properties:e.properties},polygons:{polygonIndices:{value:s.polygonIndices,size:1},primitivePolygonIndices:{value:s.primitivePolygonIndices,size:1},positions:{value:s.positions,size:n},globalFeatureIds:{value:s.globalFeatureIds,size:1},featureIds:{value:s.featureIds,size:1},numericProps:s.numericProps,properties:s.properties}};for(const t in o)for(const e in o[t].numericProps)o[t].numericProps[e]={value:o[t].numericProps[e],size:1};return o}(y,b,m,p)}function it(t,e,s,n,o){e.positions.set(t,s.pointPosition*n),e.globalFeatureIds[s.pointPosition]=s.feature,e.featureIds[s.pointPosition]=s.pointFeature,lt(e,o,s.pointPosition,1),s.pointPosition++}function rt(t,e,s,n,o){for(const i of t)it(i,e,s,n,o)}function at(t,e,s,n,o){e.pathIndices[s.linePath]=s.linePosition,s.linePath++,dt(e.positions,t,s.linePosition,n);const i=t.length;lt(e,o,s.linePosition,i),e.globalFeatureIds.set(new Uint32Array(i).fill(s.feature),s.linePosition),e.featureIds.set(new Uint32Array(i).fill(s.lineFeature),s.linePosition),s.linePosition+=i}function ht(t,e,s,n,o){for(const i of t)at(i,e,s,n,o)}function ct(t,e,s,n,o){e.polygonIndices[s.polygonObject]=s.polygonPosition,s.polygonObject++;for(const i of t){e.primitivePolygonIndices[s.polygonRing]=s.polygonPosition,s.polygonRing++,dt(e.positions,i,s.polygonPosition,n);const t=i.length;lt(e,o,s.polygonPosition,t),e.globalFeatureIds.set(new Uint32Array(t).fill(s.feature),s.polygonPosition),e.featureIds.set(new Uint32Array(t).fill(s.polygonFeature),s.polygonPosition),s.polygonPosition+=t}}function ut(t,e,s,n,o){for(const i of t)ct(i,e,s,n,o)}function lt(t,e,s,n){for(const o in t.numericProps)o in e&&t.numericProps[o].set(new Array(n).fill(e[o]),s)}function pt(t,e){for(const s in t)e.includes(s)&&delete t[s];return t}function dt(t,e,s,n){let o=s*n;for(const s of e)t.set(s,o),o+=n}function ft(t){return[].concat(...t)}const gt={geojson:{TableBatch:o,batchSize:"auto",workerUrl:"https://unpkg.com/@loaders.gl/json@2.3.0-alpha.12/dist/geojson-loader.worker.js"},json:{jsonpaths:["$","$.features"]},gis:{format:"geojson"}},yt={id:"geojson",name:"GeoJSON",version:"2.3.0-alpha.12",extensions:["geojson"],mimeTypes:["application/geo+json"],category:"geometry",text:!0,options:gt},bt={...yt,parse:async function(t,e){return mt((new TextDecoder).decode(t),e)},parseTextSync:mt,parseInBatches:async function(t,e){(e={...gt,...e}).json={...gt.geojson,...e.geojson};const s=W(t,e);switch(e.gis.format){case"binary":return async function*(t){for await(const e of t)e.data=st(e.data),yield e}(s);default:return s}}};function mt(t,e){(e={...gt,...e}).json={...gt.geojson,...e.geojson},e.gis=e.gis||{};const s=i(t,e);switch(e.gis.format){case"binary":return st(s);default:return s}}}])}));